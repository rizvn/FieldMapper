<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Field Mapper by rizvn</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Field Mapper</h1>
        <p>A library to convert a list of maps to a list of objects. </p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/rizvn/FieldMapper" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/rizvn/FieldMapper/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/rizvn/FieldMapper/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a id="fieldmapper-and-resultmap" class="anchor" href="#fieldmapper-and-resultmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>FieldMapper and ResultMap</h1>

<p>A library to convert list of maps <code>List&lt;Map&lt;String,Object&gt;&gt;</code> to a list of objects. It can be used with database access libraries such as spring jdbc, and JDBI which can return a list of maps from queries.</p>

<p><strong>ResultMap</strong> can be used where classes are not required. So you can convert <code>List&lt;Map&lt;String, Object&gt;&gt;</code> to <code>List&lt;ResultMap&gt;</code> and have convenient methods to access values with types.</p>

<h2>
<a id="maven" class="anchor" href="#maven" aria-hidden="true"><span class="octicon octicon-link"></span></a>Maven</h2>

<p>The jars are hosted in github repo:</p>

<pre><code>  &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;FieldMapper Repo&lt;/id&gt;
            &lt;url&gt;https://raw.github.com/rizvn/FieldMapper/mvn-repo/&lt;/url&gt;
        &lt;/repository&gt;
  &lt;/repositories&gt;
</code></pre>

<p>The maven dependency is:</p>

<pre><code>&lt;dependency&gt;
   &lt;groupId&gt;com.rizvn&lt;/groupId&gt;
   &lt;artifactId&gt;fieldMapper&lt;/artifactId&gt;
   &lt;version&gt;0.1.2&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Example table schema:</p>

<pre><code>  create table users(
     id serial, 
     firstName varchar(255), 
     lastName varchar(255), 
     email varchar(255), 
     lastUpdated TIMESTAMP)
</code></pre>

<h4>
<a id="1-create-class-and-annotate-fields-with-column-comrizvnfieldmapperannotationcolumn" class="anchor" href="#1-create-class-and-annotate-fields-with-column-comrizvnfieldmapperannotationcolumn" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Create class, and annotate fields with <a href="https://github.com/Column" class="user-mention">@Column</a> (com.rizvn.fieldmapper.annotation.Column)</h4>

<p>Define a class to which we want to map results to.</p>

<pre><code>public class User {
   @Column
   String firstName;

   @Column("lastName") //names are optional
   String lastName;

   @Column
   String email;

   @Column(typeHandler = TimestampToJodaDateTime.class)
   DateTime lastUpdated;

   /** Getters and setters */
}
</code></pre>

<h4>
<a id="2-run-query" class="anchor" href="#2-run-query" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Run query</h4>

<p>Run the query and return a list of maps. Below is a Spring JDBC Template example.</p>

<pre><code>List&lt;Map&lt;String, Object&gt;&gt; results = jdbcTemplate.queryForList("SELECT * FROM USERS");
</code></pre>

<h4>
<a id="3-convert-maps-to-objects" class="anchor" href="#3-convert-maps-to-objects" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Convert maps to objects</h4>

<p>Now we call <code>FieldMapper.mapListToObjectList(..)</code> to map the list of maps to list of objects</p>

<pre><code>List&lt;User&gt; users = FieldMapper.mapListToObjectList(results, User.class);
</code></pre>

<h2>
<a id="column" class="anchor" href="#column" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/Column" class="user-mention">@Column</a>
</h2>

<p>By default FieldMapper will look for the key that matches the instance variable name in the map. You can override this behavior by specifying the database column name manually i.e <code>@Column('FIRST_NAME')</code>.</p>

<p>Once the key is found, instance variable value will be set to the key's value. It will transparently handle most java types. However you may provide your own handlers through the <code>typeHandler</code> attribute on <a href="https://github.com/Column" class="user-mention">@Column</a> <code>@Column(typeHandler = TimestampToJodaDateTime.class)</code></p>

<h2>
<a id="typehandler" class="anchor" href="#typehandler" aria-hidden="true"><span class="octicon octicon-link"></span></a>TypeHandler</h2>

<p>Below is the TypeHandler interface</p>

<pre><code>public interface TypeHandler {
  public &lt;TargetType&gt; TargetType transform(Object src);
}
</code></pre>

<p>It takes value from the map and returns the transformed value, which will be set as the instance variable value.</p>

<p>Below is the code for <code>TimestampToJodaDateTime</code> Type handler used in the User Class example above. <code>java.sql.Timestamp</code> is converted  to a DateTime object. The returned value will be set as instance variable value.</p>

<pre><code>public class TimestampToJodaDateTime implements TypeHandler{
  @Override
  public DateTime transform(Object src) {
    Timestamp timestamp = (Timestamp) src;
    return new DateTime(timestamp);
  }
}
</code></pre>

<h1>
<a id="resultmap" class="anchor" href="#resultmap" aria-hidden="true"><span class="octicon octicon-link"></span></a>ResultMap</h1>

<p>If you don't want to create classes, you can use use the ResultMap. ResultMap extends HashMap with 4 additional methods:</p>

<ul>
<li><code>&lt;T&gt; T getTyped(String key)</code></li>
<li><code>&lt;T&gt; T getTyped(String key, TypeHandler typeHandler)</code></li>
<li><code>&lt;T&gt; T getTyped(Enum keyEnum)</code></li>
<li><code>&lt;T&gt; T getTyped(Enum keyEnum, TypeHandler typeHandler)</code></li>
</ul>

<p>You can transform any <code>List&lt;Map&lt;String, Object&gt;&gt;</code> to <code>List&lt;ResultMap&gt;</code> by calling <code>ResultMap.create(...)</code></p>

<h2>
<a id="result-map-example" class="anchor" href="#result-map-example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Result Map Example</h2>

<pre><code>//Transform list of maps to list of result map
List&lt;ResultMap&gt; results = ResultMap.create(jdbcTemplate.queryForList("SELECT * FROM USERS"));

//get typed value, specifying the key as a string
String firstName = results.get(0).getTyped("FIRSTNAME");

//get lastUpdated as Joda DateTime using typeHandler
DateTime lastUpdated = results.get(0).getTyped("LASTUPDATED", new TimestampToJodaDateTime());
</code></pre>

<p>For Convenience there are also enum versions of the getTyped methods. Below is an example</p>

<pre><code>static enum Users{
    FIRSTNAME, LASTUPDATED
}

List&lt;ResultMap&gt; results = ResultMap.create(jdbcTemplate.queryForList("SELECT * FROM USERS"));

//get typed value, using enum
String firstName = results.get(0).getTyped(Users.FIRSTNAME);

//get lastUpdated as Joda DateTime using typeHandler
DateTime lastUpdated = results.get(0).getTyped(Users.LASTUPDATED, new TimestampToJodaDateTime());
</code></pre>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/rizvn">rizvn</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>