<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Fieldmapper by rizvn</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Fieldmapper</h1>
        <p class="header">A library to convert a list of maps to a list of objects. </p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/rizvn/FieldMapper/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/rizvn/FieldMapper/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/rizvn/FieldMapper">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/rizvn">rizvn</a></p>


      </header>
      <section>
        <h1>
<a id="field-mapper" class="anchor" href="#field-mapper" aria-hidden="true"><span class="octicon octicon-link"></span></a>Field Mapper</h1>

<p>A library to convert list of maps <code>List&lt;Map&lt;String,Object&gt;&gt;</code> to a list of objects. It can be used with database access libraries such as spring jdbc, and JDBI which can return a list of maps from queries.</p>

<h2>
<a id="maven" class="anchor" href="#maven" aria-hidden="true"><span class="octicon octicon-link"></span></a>Maven</h2>

<p>The jars are hosted in github repo:</p>

<pre><code>  &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;FieldMapper Repo&lt;/id&gt;
            &lt;url&gt;https://raw.github.com/rizvn/FieldMapper/mvn-repo/&lt;/url&gt;
        &lt;/repository&gt;
  &lt;/repositories&gt;
</code></pre>

<p>The maven dependency is:</p>

<pre><code>&lt;dependency&gt;
   &lt;groupId&gt;com.rizvn&lt;/groupId&gt;
   &lt;artifactId&gt;fieldMapper&lt;/artifactId&gt;
   &lt;version&gt;0.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Example table schema:</p>

<pre><code>  create table users(
     id serial, 
     firstName varchar(255), 
     lastName varchar(255), 
     email varchar(255), 
     lastUpdated TIMESTAMP)
</code></pre>

<h4>
<a id="1-create-class-and-annotate-fields-with-column" class="anchor" href="#1-create-class-and-annotate-fields-with-column" aria-hidden="true"><span class="octicon octicon-link"></span></a>1. Create class, and annotate fields with <a href="https://github.com/Column" class="user-mention">@Column</a>
</h4>

<p>We want to run a query to select all users and map the results to a User class. So we first defined a user class</p>

<pre><code>public class User {
   @Column
   String firstName;

   @Column("lastName")
   String lastName;

   @Column
   String email;

   @Column(typeHandler = TimestampToJodaDateTime.class)
   DateTime lastUpdated;

   /** Getters and setters */
}
</code></pre>

<h4>
<a id="2-run-query" class="anchor" href="#2-run-query" aria-hidden="true"><span class="octicon octicon-link"></span></a>2. Run query</h4>

<p>Now use spring's jdbcTemplate to run the query and return a list of maps.</p>

<pre><code>List&lt;Map&lt;String, Object&gt;&gt; results = jdbcTemplate.queryForList("SELECT * FROM USERS");
</code></pre>

<h4>
<a id="3-convert-maps-to-objects" class="anchor" href="#3-convert-maps-to-objects" aria-hidden="true"><span class="octicon octicon-link"></span></a>3. Convert maps to objects</h4>

<p>Now we call <code>FieldMapper.mapListToObjectList(..)</code> to map the list of maps to list of objects</p>

<pre><code>List&lt;User&gt; users = FieldMapper.mapListToObjectList(results, User.class);
</code></pre>

<h2>
<a id="column" class="anchor" href="#column" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/Column" class="user-mention">@Column</a>
</h2>

<p>By default FieldMapper will look for the key that matches the instance variable name in the map. You can override this behavior by specifying the database column name manually <code>@Column('FIRST_NAME')</code>.</p>

<p>Once the key is found, instance variable value will be set to the key's value. It will transparently handle most java types. However you may provide your own handlers through the <code>typeHandler</code> attribute on <a href="https://github.com/Column" class="user-mention">@Column</a> <code>@Column(typeHandler = TimestampToJodaDateTime.class)</code></p>

<h2>
<a id="typehandler" class="anchor" href="#typehandler" aria-hidden="true"><span class="octicon octicon-link"></span></a>TypeHandler</h2>

<p>Below is the type handler interface</p>

<pre><code>public interface TypeHandler {
  public &lt;TargetType&gt; TargetType transform(Object src);
}
</code></pre>

<p>It takes the key's the value, transforms it, and returns a new value to be set as instance variable value.</p>

<p>Below is the code for <code>TimestampToJodaDateTime</code> type handle used in the User Class example above. <code>java.sql.Timestamp</code> is converted  to a DateTime object. The returned value will be set as instance variable value.</p>

<pre><code>public class TimestampToJodaDateTime implements TypeHandler{
  @Override
  public DateTime transform(Object src) {
    Timestamp timestamp = (Timestamp) src;
    return new DateTime(timestamp);
  }
}
</code></pre>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
